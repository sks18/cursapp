  [1m[36m (6.1ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL) [0m
  [1m[35m (2.0ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateVersions (20151203152020)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (6.5ms)[0m  [1mCREATE TABLE "versions" ("id" serial primary key, "item_type" character varying NOT NULL, "item_id" integer NOT NULL, "event" character varying NOT NULL, "whodunnit" character varying, "object" text, "created_at" timestamp) [0m
  [1m[35m (1.5ms)[0m  CREATE  INDEX  "index_versions_on_item_type_and_item_id" ON "versions"  ("item_type", "item_id")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20151203152020"]]
  [1m[35m (8.8ms)[0m  COMMIT
Migrating to CreateDelayedJobs (20151203154714)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (5.3ms)[0m  CREATE TABLE "delayed_jobs" ("id" serial primary key, "priority" integer DEFAULT 0 NOT NULL, "attempts" integer DEFAULT 0 NOT NULL, "handler" text NOT NULL, "last_error" text, "run_at" timestamp, "locked_at" timestamp, "failed_at" timestamp, "locked_by" character varying, "queue" character varying, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (1.2ms)[0m  [1mCREATE  INDEX  "delayed_jobs_priority" ON "delayed_jobs"  ("priority", "run_at")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151203154714"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to SorceryCore (20151204090515)
  [1m[35m (0.1ms)[0m  BEGIN
DEPRECATION WARNING: `#timestamps` was called without specifying an option for `null`. In Rails 5, this behavior will change to `null: false`. You should manually specify `null: true` to prevent the behavior of your existing migrations from changing. (called from block in change at /home/kirill/base_app_m-master/db/migrate/20151204090515_sorcery_core.rb:8)
  [1m[36m (7.5ms)[0m  [1mCREATE TABLE "users" ("id" serial primary key, "email" character varying NOT NULL, "crypted_password" character varying, "salt" character varying, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (2.3ms)[0m  CREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20151204090515"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to SorceryRememberMe (20151204090516)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "users" ADD "remember_me_token" character varying
  [1m[36m (0.1ms)[0m  [1mALTER TABLE "users" ADD "remember_me_token_expires_at" timestamp[0m
  [1m[35m (4.6ms)[0m  CREATE  INDEX  "index_users_on_remember_me_token" ON "users"  ("remember_me_token")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20151204090516"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to SorceryResetPassword (20151204090517)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "users" ADD "reset_password_token" character varying
  [1m[36m (0.1ms)[0m  [1mALTER TABLE "users" ADD "reset_password_token_expires_at" timestamp[0m
  [1m[35m (0.1ms)[0m  ALTER TABLE "users" ADD "reset_password_email_sent_at" timestamp
  [1m[36m (1.3ms)[0m  [1mCREATE  INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151204090517"]]
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Migrating to SorceryUserActivation (20151204090518)
  [1m[35m (1.3ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "users" ADD "activation_state" character varying[0m
  [1m[35m (0.1ms)[0m  ALTER TABLE "users" ADD "activation_token" character varying
  [1m[36m (0.1ms)[0m  [1mALTER TABLE "users" ADD "activation_token_expires_at" timestamp[0m
  [1m[35m (1.6ms)[0m  CREATE  INDEX  "index_users_on_activation_token" ON "users"  ("activation_token")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20151204090518"]]
  [1m[35m (0.3ms)[0m  COMMIT
Migrating to SorceryBruteForceProtection (20151204090519)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (8.3ms)[0m  ALTER TABLE "users" ADD "failed_logins_count" integer DEFAULT 0
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "users" ADD "lock_expires_at" timestamp[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "users" ADD "unlock_token" character varying
  [1m[36m (1.5ms)[0m  [1mCREATE  INDEX  "index_users_on_unlock_token" ON "users"  ("unlock_token")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151204090519"]]
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Migrating to SorceryActivityLogging (20151204090520)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "users" ADD "last_login_at" timestamp[0m
  [1m[35m (0.1ms)[0m  ALTER TABLE "users" ADD "last_logout_at" timestamp
  [1m[36m (0.1ms)[0m  [1mALTER TABLE "users" ADD "last_activity_at" timestamp[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "users" ADD "last_login_from_ip_address" character varying
  [1m[36m (1.5ms)[0m  [1mCREATE  INDEX  "index_users_on_last_logout_at_and_last_activity_at" ON "users"  ("last_logout_at", "last_activity_at")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151204090520"]]
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Migrating to CreateRoles (20170409204945)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (3.0ms)[0m  [1mCREATE TABLE "roles" ("id" serial primary key, "name" character varying NOT NULL, "info" character varying NOT NULL, "full_info" text NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.0ms)[0m  CREATE UNIQUE INDEX  "index_roles_on_name" ON "roles"  ("name")
  [1m[36m (1.0ms)[0m  [1mCREATE UNIQUE INDEX  "index_roles_on_info" ON "roles"  ("info")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20170409204945"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateRoleUsers (20170409205031)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (11.8ms)[0m  [1mCREATE TABLE "role_users" ("id" serial primary key, "role_id" integer NOT NULL, "user_id" integer NOT NULL, "data" json, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.4ms)[0m  CREATE  INDEX  "index_role_users_on_role_id" ON "role_users"  ("role_id")
  [1m[36m (1.0ms)[0m  [1mCREATE  INDEX  "index_role_users_on_user_id" ON "role_users"  ("user_id")[0m
  [1m[35m (1.1ms)[0m  ALTER TABLE "role_users" ADD CONSTRAINT "fk_rails_d517f3214f"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")

  [1m[36m (0.9ms)[0m  [1mALTER TABLE "role_users" ADD CONSTRAINT "fk_rails_d225876829"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20170409205031"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateCards (20170429190739)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (4.2ms)[0m  [1mCREATE TABLE "cards" ("id" serial primary key, "lastname" text NOT NULL, "firstname" text NOT NULL, "secondname" text, "nomer" integer, "insurancepolicy" integer, "typeoftreatment" text NOT NULL, "dateofcreation" date NOT NULL, "pindex" integer NOT NULL, "city" text NOT NULL, "street" text NOT NULL, "house" text NOT NULL, "building" text, "flat" text, "telephone" text, "passportseries" integer NOT NULL, "passportnumber" integer NOT NULL, "passsportfrom" text NOT NULL, "passportwhen" date NOT NULL, "allergy" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.5ms)[0m  CREATE UNIQUE INDEX  "index_cards_on_passportseries_and_passportnumber" ON "cards"  ("passportseries", "passportnumber")
  [1m[36m (0.3ms)[0m  [1mALTER TABLE cards ADD CONSTRAINT typecheck Check(typeoftreatment in ('–ü–ª–∞—Ç–Ω–æ','–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'))[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20170429190739"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateWards (20170429190816)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (3.0ms)[0m  [1mCREATE TABLE "wards" ("id" serial primary key, "floor" integer NOT NULL, "nomer" integer NOT NULL, "otdel" text NOT NULL, "capacity" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.1ms)[0m  CREATE UNIQUE INDEX  "index_wards_on_floor_and_nomer" ON "wards"  ("floor", "nomer")
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20170429190816"]]
  [1m[35m (0.6ms)[0m  COMMIT
Migrating to CreatePeriods (20170429190830)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (3.3ms)[0m  CREATE TABLE "periods" ("id" serial primary key, "dateofentrance" date NOT NULL, "reasonofentrance" text NOT NULL, "dateofissue" date NOT NULL, "dischargesummary" text NOT NULL, "card_id" integer, "ward_id" integer, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.1ms)[0m  [1mCREATE  INDEX  "index_periods_on_card_id" ON "periods"  ("card_id")[0m
  [1m[35m (1.2ms)[0m  CREATE  INDEX  "index_periods_on_ward_id" ON "periods"  ("ward_id")
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "periods" ADD CONSTRAINT "fk_rails_d92ca555dd"
FOREIGN KEY ("card_id")
  REFERENCES "cards" ("id")
[0m
  [1m[35m (0.9ms)[0m  ALTER TABLE "periods" ADD CONSTRAINT "fk_rails_3abc856b6a"
FOREIGN KEY ("ward_id")
  REFERENCES "wards" ("id")

  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20170429190830"]]
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (1.9ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'cards'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (4.7ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'delayed_jobs'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.0ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'periods'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (1.8ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'role_users'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (5.2ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'roles'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (1.8ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'users'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (5.0ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'versions'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (1.7ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'wards'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m


Started GET "/" for 127.0.0.1 at 2017-04-29 22:13:49 +0300
  [1m[36mActiveRecord::SchemaMigration Load (3.5ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by WelcomeController#index as HTML
  Rendered welcome/index.html.haml within layouts/application (2.5ms)
  Rendered application/_navbar_top.html.haml (6.6ms)
  Rendered application/_sidebar.html.haml (10.4ms)
  Rendered application/_flash_messages.html.haml (1.0ms)
Completed 200 OK in 9823ms (Views: 9799.5ms | ActiveRecord: 0.0ms)


Started GET "/periods/" for 127.0.0.1 at 2017-04-29 22:14:13 +0300
Processing by PeriodsController#index as HTML
Redirected to http://localhost:3000/login
Filter chain halted as :require_login rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)


Started GET "/login" for 127.0.0.1 at 2017-04-29 22:14:13 +0300
Processing by WelcomeController#new as HTML
  Rendered welcome/_form.html.haml (8.7ms)
  Rendered welcome/new.html.haml within layouts/application (12.8ms)
  Rendered application/_navbar_top.html.haml (1.4ms)
  Rendered application/_sidebar.html.haml (3.6ms)
  Rendered application/_flash_messages.html.haml (1.8ms)
Completed 200 OK in 178ms (Views: 112.6ms | ActiveRecord: 6.2ms)
